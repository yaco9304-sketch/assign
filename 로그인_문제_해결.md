# 로그인 문제 해결 가이드

## 🔴 문제: 관리자 로그인 및 Google 로그인 모두 실패

모든 로그인이 작동하지 않는 경우, 백엔드 서버 연결 문제일 가능성이 높습니다.

## 🔍 원인 분석

### 가능한 원인들:

1. **백엔드 서버가 실행되지 않음**
   - Render 서비스가 중지됨
   - 서비스가 배포 중이거나 오류 상태

2. **CORS 설정 문제**
   - GitHub Pages 도메인이 `ALLOWED_ORIGINS`에 포함되지 않음
   - CORS 설정이 제대로 적용되지 않음

3. **API URL 설정 오류**
   - 프론트엔드의 `VITE_API_BASE_URL`이 잘못 설정됨
   - 환경 변수가 빌드 시점에 포함되지 않음

4. **네트워크 문제**
   - 방화벽이 API 요청을 차단
   - 회사/학교 네트워크 제한

## ✅ 해결 방법

### 1단계: 개발자 도구로 정확한 오류 확인

**데스크탑에서:**

1. **F12 키로 개발자 도구 열기**

2. **Console 탭 확인**
   - 빨간색 오류 메시지 확인
   - "API Error:" 로그 확인
   - "Admin login attempt - API URL:" 로그 확인

3. **Network 탭 확인**
   - `auth/login` 요청 찾기
   - 요청 상태 확인:
     - **Failed (빨간색)**: 서버에 연결할 수 없음
     - **CORS 오류**: CORS 설정 문제
     - **404**: API 엔드포인트를 찾을 수 없음
     - **500**: 서버 내부 오류

### 2단계: 백엔드 서버 상태 확인

**Render 대시보드에서:**

1. **서비스 상태 확인**
   - https://dashboard.render.com 접속
   - 백엔드 서비스 선택
   - 상태가 "Live"인지 확인

2. **최근 배포 확인**
   - "Events" 탭에서 최근 배포 상태 확인
   - 실패한 배포가 있는지 확인

3. **로그 확인**
   - "Logs" 탭에서 백엔드 로그 확인
   - 오류 메시지 확인

### 3단계: CORS 설정 확인

**Render 대시보드에서:**

1. **Environment 탭 열기**

2. **`ALLOWED_ORIGINS` 환경 변수 확인**
   ```
   https://yaco9304-sketch.github.io,https://yaco9304-sketch.github.io/assign,http://localhost:5173
   ```

3. **포함되어야 할 도메인:**
   - `https://yaco9304-sketch.github.io`
   - `https://yaco9304-sketch.github.io/assign`
   - (개발용) `http://localhost:5173`

4. **저장 후 재시작**
   - "Save Changes" 클릭
   - "Manual Deploy" 클릭하여 재시작

### 4단계: API URL 확인

**프론트엔드에서:**

1. **개발자 도구 Console 확인**
   - "Admin login attempt - API URL:" 로그 확인
   - 예상 URL: `https://assign-hfvk.onrender.com`

2. **GitHub Actions Secrets 확인**
   - GitHub 리포지토리 → Settings → Secrets and variables → Actions
   - `VITE_API_BASE_URL` 확인
   - 값: `https://assign-hfvk.onrender.com`

3. **재배포 필요 시**
   - GitHub Actions에서 수동으로 워크플로우 실행
   - 또는 코드 푸시하여 자동 배포

### 5단계: 네트워크 테스트

**브라우저에서 직접 테스트:**

1. **백엔드 서버 직접 접속**
   ```
   https://assign-hfvk.onrender.com/docs
   ```
   - FastAPI 문서 페이지가 열리면 서버는 정상 작동 중

2. **API 엔드포인트 직접 테스트**
   ```
   https://assign-hfvk.onrender.com/auth/login
   ```
   - POST 요청을 보내서 응답 확인

## 🧪 단계별 진단

### 데스크탑에서 확인할 사항

1. **개발자 도구 열기** (F12)

2. **Console 탭에서 확인:**
   ```
   - "API Error:" 로그
   - "Admin login attempt - API URL:" 로그
   - CORS 오류 메시지
   - Network Error 메시지
   ```

3. **Network 탭에서 확인:**
   - `auth/login` POST 요청 찾기
   - Status 코드 확인:
     - **0 또는 Failed**: 서버 연결 실패
     - **404**: 엔드포인트를 찾을 수 없음
     - **500**: 서버 오류
     - **CORS 오류**: CORS 설정 문제

4. **Request Headers 확인:**
   - `Origin` 헤더 확인
   - 예상: `https://yaco9304-sketch.github.io`

5. **Response 확인:**
   - 오류 메시지 확인
   - CORS 관련 헤더 확인

## 📋 체크리스트

- [ ] 개발자 도구에서 Console 오류 확인
- [ ] Network 탭에서 `auth/login` 요청 상태 확인
- [ ] Render 대시보드에서 서비스 상태 확인 (Live)
- [ ] Render에서 `ALLOWED_ORIGINS` 환경 변수 확인
- [ ] GitHub Actions Secrets에서 `VITE_API_BASE_URL` 확인
- [ ] 백엔드 서버 직접 접속 테스트 (`/docs`)
- [ ] 시크릿 모드로 테스트
- [ ] 다른 네트워크로 테스트

## 💡 빠른 해결 시도

### 방법 1: Render 서비스 재시작

1. **Render 대시보드 접속**
   - https://dashboard.render.com

2. **백엔드 서비스 선택**

3. **"Manual Deploy" 클릭**

4. **재시작 완료 대기 (1-2분)**

5. **다시 로그인 시도**

### 방법 2: CORS 설정 재확인

1. **Render → Environment → `ALLOWED_ORIGINS`**
   ```
   https://yaco9304-sketch.github.io,https://yaco9304-sketch.github.io/assign,http://localhost:5173
   ```

2. **저장 후 재시작**

### 방법 3: 시크릿 모드 테스트

1. **시크릿 모드 열기**
   - Ctrl+Shift+N (Windows) 또는 Cmd+Shift+N (Mac)

2. **사이트 접속**
   - `https://yaco9304-sketch.github.io/assign`

3. **로그인 테스트**

### 방법 4: 브라우저 캐시 삭제

1. **설정 → 개인정보 및 보안 → 인터넷 사용 기록 삭제**
2. **"캐시된 이미지 및 파일" 선택**
3. **"데이터 삭제" 클릭**
4. **다시 로그인 시도**

## 🐛 구체적인 오류별 해결

### CORS 오류

**오류 메시지:**
```
Access to XMLHttpRequest ... has been blocked by CORS policy
```

**해결:**
1. Render → Environment → `ALLOWED_ORIGINS` 확인
2. `https://yaco9304-sketch.github.io` 포함 확인
3. 서비스 재시작

### Network Error / Failed

**오류 메시지:**
```
Network Error
Failed to fetch
서버에 연결할 수 없습니다
```

**해결:**
1. Render 대시보드에서 서비스 상태 확인
2. 서비스가 "Live" 상태인지 확인
3. 서비스 재시작
4. 백엔드 서버 직접 접속 테스트 (`/docs`)

### 404 Not Found

**오류 메시지:**
```
404 Not Found
```

**해결:**
1. API URL 확인 (`VITE_API_BASE_URL`)
2. 백엔드 서버가 정상 작동하는지 확인
3. 엔드포인트 경로 확인 (`/auth/login`)

### 500 Internal Server Error

**오류 메시지:**
```
500 Internal Server Error
```

**해결:**
1. Render 대시보드 → Logs 탭
2. 백엔드 로그 확인
3. 오류 원인 파악

## 📞 디버깅 정보 수집

데스크탑에서 다음 정보를 수집해주세요:

1. **Console 오류 메시지**
   - F12 → Console 탭 → 오류 메시지 복사
   - "API Error:" 로그 복사

2. **Network 요청 상태**
   - F12 → Network 탭 → `auth/login` 요청 클릭
   - Status 코드 확인
   - Request Headers 확인
   - Response 내용 확인

3. **API URL 확인**
   - Console에서 "Admin login attempt - API URL:" 로그 확인

4. **백엔드 서버 상태**
   - `https://assign-hfvk.onrender.com/docs` 접속 가능 여부

이 정보를 알려주시면 더 정확한 해결 방법을 제시할 수 있습니다.

