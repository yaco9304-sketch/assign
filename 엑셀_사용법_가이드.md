# 엑셀 기반 학년 배정 자동화 사용법

## 📋 목차
1. [필수 요구사항](#필수-요구사항)
2. [템플릿 파일 생성](#템플릿-파일-생성)
3. [엑셀 파일 작성 방법](#엑셀-파일-작성-방법)
4. [배정 실행 방법](#배정-실행-방법)
5. [결과 확인](#결과-확인)
6. [문제 해결](#문제-해결)

---

## 필수 요구사항

### Python 패키지 설치
```bash
pip install openpyxl
```

또는 requirements.txt가 있다면:
```bash
pip install -r requirements.txt
```

---

## 템플릿 파일 생성

### 1단계: 템플릿 엑셀 파일 생성

터미널에서 다음 명령어를 실행하세요:

```bash
python 학년배정_자동화.py --template 학년배정_템플릿.xlsx
```

또는 파일명을 지정하지 않으면 기본 파일명으로 생성됩니다:

```bash
python 학년배정_자동화.py --template
```

**생성되는 파일:**
- `학년배정_템플릿.xlsx` (또는 지정한 파일명)

**생성되는 시트:**
1. **교사정보** 시트
2. **희망사항** 시트
3. **학년설정** 시트

---

## 엑셀 파일 작성 방법

### 📝 시트 1: 교사정보

다음 컬럼들을 채워주세요:

| 컬럼명 | 설명 | 필수 | 예시 |
|--------|------|------|------|
| 이름 | 교사 이름 | ✅ 필수 | 홍길동 |
| 성별 | 성별 | ❌ 선택 | 남, 여 |
| 임용년도 | 교사 임용 연도 | ❌ 선택 | 2010 |
| 본교입사년도 | 본교 입사 연도 | ❌ 선택 | 2015 |
| 현재 학년 | 올해 담당 학년 | ❌ 선택 | 3 |
| 현재 반 | 올해 담당 반 | ❌ 선택 | 1반 |
| 현재 담임 여부 | 올해 담임 여부 (TRUE/FALSE) | ❌ 선택 | TRUE |
| 교과전담 여부 | 교과전담 여부 (TRUE/FALSE) | ❌ 선택 | FALSE |
| 역할 | 업무부장, 학년부장 등 | ❌ 선택 | 업무1부장 |
| 담당 교과 | 담당 교과명 | ❌ 선택 | 수학 |
| 특수 조건 | 특수 사유 (휴직, 병가, 원로 등) | ❌ 선택 | 원로 |
| 본교 담임 이력 | 과거 담임 이력 (형식: "연도:학년,연도:학년") | ❌ 선택 | 2023:1,2024:2 |

**본교 담임 이력 작성 예시:**
- 단일 이력: `2023:1`
- 여러 이력: `2023:1,2024:2,2025:3`
- JSON 형식도 가능: `[{"year": 2023, "grade": 1}, {"year": 2024, "grade": 2}]`

---

### 📝 시트 2: 희망사항

다음 컬럼들을 채워주세요:

| 컬럼명 | 설명 | 필수 | 예시 |
|--------|------|------|------|
| 교사 이름 | 교사 이름 (교사정보 시트와 동일) | ✅ 필수 | 홍길동 |
| 1지망 | 1지망 학년 | ❌ 선택 | 3 |
| 2지망 | 2지망 학년 | ❌ 선택 | 4 |
| 3지망 | 3지망 학년 | ❌ 선택 | 5 |
| 학년부장 | 학년부장 희망 여부 (TRUE/FALSE) | ❌ 선택 | FALSE |
| 교과전담 | 교과전담 희망 여부 (TRUE/FALSE) | ❌ 선택 | FALSE |
| 업무부장 | 업무부장 희망 여부 (TRUE/FALSE) | ❌ 선택 | FALSE |
| 비고 | 기타 메모 | ❌ 선택 | 건강상의 이유로 3학년 희망 |

**참고:**
- 희망사항 시트는 선택사항입니다. 없어도 배정은 가능합니다.
- 교사 이름은 교사정보 시트의 이름과 정확히 일치해야 합니다.

---

### 📝 시트 3: 학년설정

다음 컬럼들을 채워주세요:

| 컬럼명 | 설명 | 필수 | 예시 |
|--------|------|------|------|
| 학년 | 학년 (1~6) | ✅ 필수 | 1 |
| 학급 수 | 해당 학년의 학급 수 | ❌ 선택 | 4 |
| 필요 담임 수 | 해당 학년에 필요한 담임 수 | ✅ 필수 | 4 |
| 필요 교과전담 수 | 해당 학년에 필요한 교과전담 수 | ❌ 선택 | 2 |
| 필요 업무부장 수 | 해당 학년에 필요한 업무부장 수 | ❌ 선택 | 1 |

**중요:**
- **필요 담임 수**는 반드시 입력해야 합니다. 이 값이 0이면 배정이 실패합니다.
- 각 학년별로 한 행씩 작성하세요 (1학년, 2학년, 3학년, 4학년, 5학년, 6학년).

---

## 배정 실행 방법

### 기본 실행

```bash
python 학년배정_자동화.py <엑셀파일경로> [배정연도]
```

**예시:**
```bash
# 배정 연도를 지정하지 않으면 내년도로 자동 설정
python 학년배정_자동화.py 학년배정_템플릿.xlsx

# 배정 연도를 명시적으로 지정
python 학년배정_자동화.py 학년배정_템플릿.xlsx 2026
```

### 실행 과정

스크립트가 실행되면 다음과 같은 과정을 거칩니다:

1. 📖 **엑셀 파일 읽기**
   - 교사정보 시트 읽기
   - 희망사항 시트 읽기
   - 학년설정 시트 읽기

2. 🔄 **배정 알고리즘 실행**
   - 제외 대상 필터링 (제13조: 휴직, 병가, 파견 등)
   - 우선 배정 규칙 적용 (제12조④: 특수 사유 우선)
   - 역할 우선 배정 (제12조②: 업무부장, 학년부장 등)
   - 학년 순환 규칙 적용 (제12조①: 동일 학년 제한)
   - 희망 학년 반영 (제11조: 1지망→2지망→3지망)
   - 점수 기반 조정 배정

3. 💾 **결과 저장**
   - 원본 파일명에 `_배정결과_연도.xlsx`가 추가된 새 파일 생성

---

## 결과 확인

### 생성되는 파일

배정이 완료되면 다음 파일이 생성됩니다:

```
원본파일명_배정결과_2026.xlsx
```

예: `학년배정_템플릿_배정결과_2026.xlsx`

### 결과 파일의 시트

#### 1. 배정결과 시트

| 컬럼명 | 설명 |
|--------|------|
| 교사 이름 | 교사 이름 |
| 배정 학년 | 배정된 학년 |
| 배정 유형 | 규정우선, 1지망, 2지망, 3지망, 조정 |
| 적용 규정 | 적용된 규정 조항 |
| 상세 근거 | 배정 근거 상세 설명 |

**배정 유형 설명:**
- **규정우선**: 제12조②(역할 우선), 제12조④(특수 사유 우선)에 따라 배정
- **1지망/2지망/3지망**: 희망 학년 반영 (제11조)
- **조정**: 점수 기반 조정 배정

#### 2. 학년별통계 시트

| 컬럼명 | 설명 |
|--------|------|
| 학년 | 학년 |
| 배정 인원 수 | 해당 학년에 배정된 교사 수 |

#### 3. 제외 대상 섹션

배정결과 시트 하단에 제외 대상 목록이 표시됩니다:
- 교사 이름
- 제외 사유 (제13조 관련 사유)

---

## 배정 규칙 상세

### 제11조: 희망 학년 반영
- 교사의 1지망, 2지망, 3지망을 우선적으로 반영합니다.

### 제12조①: 학년 순환 원칙
- 올해 담당한 학년은 다음 해에 배정되지 않습니다.
- 단, 1학년/6학년은 동일 학년 희망 시 제한이 완화됩니다.
- 본교 근무 기간 동안 동일 학년을 2번 이상 담임한 경우 제외됩니다.

### 제12조②: 역할 우선 배정
- 업무부장, 학년부장, 교과전담 등 역할이 있는 교사는 우선 배정됩니다.
- 역할별 점수:
  - 업무1부장: 6.0점
  - 업무2부장: 5.0점
  - 업무3부장: 4.3점
  - 교과전담: 3.0점
  - 학년부장: 2.0점

### 제12조④: 특수 사유 우선 배정
- 원로, 요양, 건강, 군입대, 출산, 임신 등의 특수 사유가 있는 교사는 우선 배정됩니다.

### 제13조: 배정 제외
- 다음 사유가 있는 교사는 배정에서 제외됩니다:
  - 휴직
  - 병가 (30일 이상)
  - 파견
  - 연수
  - 산전/임신/출산 예정
  - 고령 교사

---

## 문제 해결

### ❌ 오류: "교사정보 시트가 없습니다"
**해결:** 엑셀 파일에 "교사정보" 시트가 있는지 확인하세요. 시트 이름이 정확히 일치해야 합니다.

### ❌ 오류: "학년설정 시트가 없습니다"
**해결:** 엑셀 파일에 "학년설정" 시트가 있는지 확인하세요.

### ❌ 오류: "필요 담임 수가 0입니다"
**해결:** 학년설정 시트에서 각 학년의 "필요 담임 수" 컬럼에 값을 입력하세요.

### ❌ 오류: "파일을 찾을 수 없습니다"
**해결:** 
- 파일 경로가 정확한지 확인하세요.
- 상대 경로 대신 절대 경로를 사용해보세요.
- 파일명에 한글이 포함된 경우 따옴표로 감싸세요: `"학년배정_템플릿.xlsx"`

### ❌ 오류: "openpyxl 모듈을 찾을 수 없습니다"
**해결:** 
```bash
pip install openpyxl
```

### ⚠️ 배정 결과가 예상과 다릅니다
**확인 사항:**
1. 교사정보의 "본교 담임 이력"이 올바르게 입력되었는지 확인
2. 희망사항의 1지망, 2지망, 3지망이 올바르게 입력되었는지 확인
3. 특수 조건이 올바르게 입력되었는지 확인
4. 학년설정의 "필요 담임 수"가 올바르게 입력되었는지 확인

---

## 사용 예시

### 전체 프로세스 예시

```bash
# 1. 템플릿 파일 생성
python 학년배정_자동화.py --template 학년배정_템플릿.xlsx

# 2. 엑셀 파일 열어서 데이터 입력
# - 교사정보 시트에 교사 정보 입력
# - 희망사항 시트에 희망사항 입력 (선택)
# - 학년설정 시트에 학년별 설정 입력

# 3. 배정 실행
python 학년배정_자동화.py 학년배정_템플릿.xlsx 2026

# 4. 결과 확인
# - 학년배정_템플릿_배정결과_2026.xlsx 파일 확인
```

---

## 추가 팁

### 💡 팁 1: 데이터 백업
배정 실행 전에 원본 엑셀 파일을 백업하세요.

### 💡 팁 2: 단계별 확인
처음 사용하시는 경우, 소수의 교사 데이터로 먼저 테스트해보세요.

### 💡 팁 3: 결과 검토
배정 결과를 확인한 후, 필요시 수동으로 조정할 수 있습니다.

### 💡 팁 4: 본교 담임 이력 관리
매년 배정 후, 교사정보 시트의 "본교 담임 이력"을 업데이트하세요.

---

## 문의 및 지원

문제가 발생하거나 질문이 있으시면 개발팀에 문의해주세요.

