# 엑셀 기반 학년 배정 자동화 가이드

이 가이드는 엑셀 파일을 사용하여 학년 배정을 자동으로 수행하는 방법을 설명합니다.

## 📋 필요 사항

- Python 3.8 이상
- `openpyxl` 라이브러리

## 🔧 설치 방법

```bash
pip install openpyxl
```

## 📝 사용 방법

### 1. 템플릿 파일 생성

먼저 엑셀 템플릿 파일을 생성합니다:

```bash
python 학년배정_자동화.py --template 학년배정_템플릿.xlsx
```

이 명령어를 실행하면 다음 3개의 시트가 포함된 엑셀 파일이 생성됩니다:
- **교사정보**: 교사 기본 정보
- **희망사항**: 교사별 희망 학년 및 역할
- **학년설정**: 학년별 필요 인원 수

### 2. 데이터 입력

생성된 템플릿 파일에 데이터를 입력합니다.

#### 교사정보 시트

| 열 이름 | 설명 | 예시 |
|---------|------|------|
| 이름 | 교사 이름 (필수) | 홍길동 |
| 성별 | 성별 | 남/여 |
| 임용년도 | 임용 연도 | 2010 |
| 본교입사년도 | 본교 입사 연도 | 2015 |
| 현재 학년 | 현재 담임 학년 | 3 |
| 현재 반 | 현재 담임 반 | 1반 |
| 현재 담임 여부 | 담임 여부 (TRUE/FALSE) | TRUE |
| 교과전담 여부 | 교과전담 여부 (TRUE/FALSE) | FALSE |
| 역할 | 업무부장/학년부장 등 | 업무1부장 |
| 담당 교과 | 담당 교과 | 수학 |
| 특수 조건 | 특수 조건 (휴직, 임신, 원로 등) | 원로교사 |
| 본교 담임 이력 | 본교 근무 기간 동안 담임한 학년 이력 | 2023:1,2024:2 |

**본교 담임 이력 형식:**
- `연도:학년,연도:학년` 형식으로 입력
- 예: `2023:1,2024:2` (2023년 1학년, 2024년 2학년 담임)

#### 희망사항 시트

| 열 이름 | 설명 | 예시 |
|---------|------|------|
| 교사 이름 | 교사 이름 (교사정보 시트와 일치) | 홍길동 |
| 1지망 | 1지망 학년 | 4 |
| 2지망 | 2지망 학년 | 5 |
| 3지망 | 3지망 학년 | 6 |
| 학년부장 | 학년부장 희망 (TRUE/FALSE) | TRUE |
| 교과전담 | 교과전담 희망 (TRUE/FALSE) | FALSE |
| 업무부장 | 업무부장 희망 (TRUE/FALSE) | FALSE |
| 비고 | 기타 메모 | - |

#### 학년설정 시트

| 열 이름 | 설명 | 예시 |
|---------|------|------|
| 학년 | 학년 (1~6) | 1 |
| 학급 수 | 해당 학년의 학급 수 | 4 |
| 필요 담임 수 | 필요한 담임 교사 수 | 4 |
| 필요 교과전담 수 | 필요한 교과전담 교사 수 | 1 |
| 필요 업무부장 수 | 필요한 업무부장 수 | 0 |

### 3. 배정 실행

데이터 입력이 완료되면 다음 명령어로 배정을 실행합니다:

```bash
python 학년배정_자동화.py 학년배정_템플릿.xlsx 2026
```

- 첫 번째 인자: 엑셀 파일 경로
- 두 번째 인자: 배정 연도 (생략 시 내년도 자동 설정)

### 4. 결과 확인

배정이 완료되면 원본 파일과 같은 위치에 `학년배정_템플릿_배정결과_2026.xlsx` 파일이 생성됩니다.

이 파일에는 다음 시트가 포함됩니다:

#### 배정결과 시트

| 열 이름 | 설명 |
|---------|------|
| 교사 이름 | 교사 이름 |
| 배정 학년 | 배정된 학년 |
| 배정 유형 | 규정우선/1지망/2지망/3지망/조정 |
| 적용 규정 | 적용된 규정 조항 |
| 상세 근거 | 배정 근거 상세 설명 |

또한 제외 대상 목록도 함께 표시됩니다.

#### 학년별통계 시트

각 학년별로 배정된 인원 수를 표시합니다.

## 🎯 배정 규칙

### 1. 제외 대상 (제13조)
- 휴직, 병가(30일 이상), 파견, 연수, 임신, 출산, 고령 교사 등은 배정에서 제외됩니다.

### 2. 우선 배정 규칙

#### 제12조④: 특수 사유 우선 배정
- 원로교사, 요양 필요, 건강 사유, 군 입대, 출산 예정, 임신 등
- 1지망 → 2지망 → 3지망 순으로 우선 배정

#### 제12조②: 역할 우선 배정
- 업무부장(6점) > 학년부장(2점) > 교과전담(3점) 순으로 점수 기반 배정

### 3. 학년 순환 규칙 (제12조①)
- 올해 담당 학년은 다음 해 배정에서 제외
- 단, 1학년/6학년은 동일 학년 희망 시 예외
- **동일 학년 2번 제한**: 본교 근무 기간 동안 같은 학년을 2번 이상 담임한 경우 해당 학년은 선택 불가

### 4. 교과전담 규칙
- 교과전담 교사는 담임 배정에서 제외

### 5. 희망 학년 배정
- 1지망 → 2지망 → 3지망 순으로 배정

### 6. 점수 기반 조정 배정
- 남은 슬롯은 다음 점수로 계산:
  - 희망 점수: 1지망(10점), 2지망(5점), 3지망(2점)
  - 학년 가중치: 6학년(6점), 1학년(5점), 5학년(4점), 3-4학년(3점), 2학년(2점)
  - 역할 점수: 업무부장(6점), 교과전담(3점), 학년부장(2점)

## ⚠️ 주의사항

1. **교사 이름 일치**: 희망사항 시트의 "교사 이름"은 교사정보 시트의 "이름"과 정확히 일치해야 합니다.

2. **본교 담임 이력 형식**: 
   - 올바른 형식: `2023:1,2024:2`
   - 잘못된 형식: `2023-1,2024-2` (하이픈 사용), `2023년1학년` (한글 포함)

3. **필요 담임 수**: 학년설정 시트의 "필요 담임 수"는 실제로 배정할 수 있는 인원 수와 일치해야 합니다.

4. **교과전담 여부**: 교과전담 교사는 담임 배정에서 자동으로 제외됩니다.

## 🔍 문제 해결

### 오류: "필요 담임 수가 0입니다"
- 학년설정 시트에서 각 학년의 "필요 담임 수"를 확인하세요.

### 오류: "교사 데이터가 없습니다"
- 교사정보 시트에 데이터가 올바르게 입력되었는지 확인하세요.
- "이름" 열에 값이 있는지 확인하세요.

### 배정 결과가 예상과 다름
- 본교 담임 이력이 올바르게 입력되었는지 확인하세요.
- 특수 조건이 올바르게 입력되었는지 확인하세요.
- 희망사항이 올바르게 입력되었는지 확인하세요.

## 📞 문의

문제가 발생하거나 개선 사항이 있으면 개발자에게 문의하세요.


